<!DOCTYPE html>
<html lang="en">
<head>
  <!-- an extremely simple md tool by COPILOT & QLiu -->
  <meta charset="UTF-8">
  <title>QLiu:: Markdown Edit & View</title>
  <!-- script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script -->
  <script src="utils/marked.min.js"></script>

  <link rel="stylesheet" type="text/css" media="all" href="utils/ql_md_copilot.css">
  <link rel="stylesheet" type="text/css" media="all" href="utils/ql_gemini.css">
  <style>
	textarea { width: 100%; min-height: 80px;
		resize: none; /* Disable resizing */
	}
	
	button {
	  padding: 8px 12px;
	  background-color: #4CAF50;
	  color: white;
	  border: none;
	  border-radius: 4px;
	  cursor: pointer;
	  font-size: 14px;
	  transition: background-color 0.3s ease;
	}
	button:hover { background-color: #45a049; }
  </style>
</head>
<body>
  <h2>Markdown:üìùEdit & View</h2>
  <button onclick="copyToClipboard()">üìãCopy</button><br>
  <button onclick="saveToFile()">üíæSave</button><br>
  &nbsp;&nbsp;&nbsp;&nbsp;<i id="msg"></i>
  
  <div class="container">
  <div class="column">
	<div id="markdownOut"></div>
  </div>
  <div class="column"><i>Write your markdown in the box below</i>:<br><br>
	<textarea id="markdownIn" placeholder="# Type here..."></textarea>
  </div></div>


  <script>
    const input = document.getElementById('markdownIn');
    const output = document.getElementById('markdownOut');

    function renderMarkdown() {
      const markdownText = input.value;
      output.innerHTML = marked.parse(markdownText);
    }

    input.addEventListener('input', renderMarkdown);
    renderMarkdown(); 
  </script>
  
  <script>
    // increase height of textarea automatically
	document.getElementById('markdownIn').addEventListener('input', function() {
	this.style.height = 'auto';
	this.style.height = (this.scrollHeight) + 'px';
	});
  </script>

  <script>
	const msg = document.getElementById('msg');
	
    function copyToClipboard() {
      const text = document.getElementById('markdownIn').value;
      navigator.clipboard.writeText(text)
		.then(() => msg.innerHTML = 'copied to clipboard' )
        .catch(err => alert('XCP copy: ' + err));
    }

    async function saveToFile() {
      const text = document.getElementById('markdownIn').value;

      try {
        const handle = await window.showSaveFilePicker({
          suggestedName: 'README.md',
          types: [{
            description: 'Text Files',
            accept: { 'text/plain': ['.md','.txt'] }
          }]
        });

        const writable = await handle.createWritable();
        await writable.write(text);
        await writable.close();
		msg.innerHTML = 'saved to file';
      } catch (err) {
        alert('XCP save file: ' + err);
      }
    }
  </script>

</body>
</html>
